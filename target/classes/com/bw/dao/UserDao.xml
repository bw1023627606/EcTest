<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bw.dao.UserDao">
	<sql id="user_sql">
		`id`,
		`username`,
		`birthday`,
		`sex`,
		`address`
	</sql>
	<!-- foreach查询 -->
	<select id="getUserByIdFor" parameterType="QueryVo" resultType="User">
		SELECT
		<include refid="user_sql"/>
		FROM `user`
		<where>
			<foreach collection="uids" open="id IN(" item="uId" separator="," close=")">
				#{uId}
			</foreach>
		</where>
	</select>
	
	
	<!-- 查询 -->
	<select id="getUserById" parameterType="int" resultType="User">
		SELECT
		`id`,
		`username`,
		`birthday`,
		`sex`,
		`address`
		FROM `user`
		WHERE id = #{id}
	</select>
	<!-- 模糊查询 -->
	<select id="getUserByName" parameterType="String"
		resultType="com.bw.entity.User">
		SELECT
		`id`,
		`username`,
		`birthday`,
		`sex`,
		`address`
		FROM `user`
		WHERE username LIKE '%${value}%'

	</select>

	<!-- 插入 -->
	<insert id="insertUser" parameterType="com.bw.entity.User"
		useGeneratedKeys="true" keyProperty="id" keyColumn="id">
		INSERT INTO `user`(
		`username`,`birthday`,`sex`,`address`
		)VALUES(
		#{username},
		#{birthday},
		#{sex},
		#{address}
		);
	</insert>
	<!-- 删除 -->
	<delete id="deleteUser" parameterType="int">
		DELETE
		FROM
		`user`
		WHERE `id`
		= #{id} ;
	</delete>
	<!-- 更新 -->
	<update id="updateUser" parameterType="com.bw.entity.User">
		UPDATE
		`user`
		SET
		`username`
		= #{username},
		`address` = #{address}
		WHERE `id` = #{id} ;
	</update>
	<!-- ======================================================== -->
	
	<!-- 查询 -->
	<select id="getUserByQueryVo" parameterType="queryvo" resultType="User">
		SELECT
		`id`,
		`username`,
		`birthday`,
		`sex`,
		`address`
		FROM `user`
		WHERE username LIKE '%${user.username}%';
	</select>
	<select id="getUserCount" resultType="int">
		SELECT COUNT(1) FROM `user`;
	</select>
</mapper>